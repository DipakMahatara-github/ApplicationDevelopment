@page "/history"
@using ApplicationDevelopment.Model
@using ApplicationDevelopment.Service
@inject NavigationManager NavManager

<h2>Journal History</h2>

@if (_entries.Count == 0)
{
    <p>No journal entries found.</p>
}
else
{
    foreach (var e in _entries)
    {
        <div class="card mb-2 p-3">
            <p><strong>Date:</strong> @e.CreatedAt</p>
            <p><strong>Mood:</strong> @e.PrimaryMood</p>
            <p>@e.Content</p>

            <button class="btn btn-sm btn-warning" @onclick="() => Edit(e.Id)">Edit</button>
            <button class="btn btn-sm btn-danger" @onclick="() => Delete(e.Id)">Delete</button>
        </div>
    }
}

@code {
    private List<JournalEntry> _entries = new();

    protected override async Task OnInitializedAsync()
    {
        _entries = await JournalService.GetAllEntriesAsync();
    }

    private void Edit(Guid id)
    {
        NavManager.NavigateTo($"/edit-entry/{id}");
    }

    private async Task Delete(Guid id)
    {
        await JournalService.DeleteEntryAsync(id);
        _entries = await JournalService.GetAllEntriesAsync();
    }
}