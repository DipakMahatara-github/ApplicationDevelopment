@using ApplicationDevelopment.Service
@inject NavigationManager NavManager

<Router AppAssembly="@typeof(Routes).Assembly">
    <Found Context="routeData">

        @if (IsProtected(routeData.PageType) && !AuthService.IsLoggedIn())
        {
            NavManager.NavigateTo("/login", true);
        }
        else
        {
            <RouteView RouteData="@routeData"
                       DefaultLayout="typeof(ApplicationDevelopment.Components.Layout.MainLayout)" />
        }

    </Found>

    <NotFound>
        <LayoutView Layout="typeof(ApplicationDevelopment.Components.Layout.MainLayout)">
            <h3>Page not found</h3>
        </LayoutView>
    </NotFound>
</Router>

@code {
    private bool IsProtected(Type pageType)
    {
        return pageType.Name switch
        {
            "AddEntry" => true,
            "History" => true,
            "EditEntry" => true,
            "Calendar" => true, 
            "Dashboard" => true,
            _ => false
        };
    }
}