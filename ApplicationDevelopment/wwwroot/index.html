<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Basic metadata and responsive configuration -->
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover" />

    <!-- Application title -->
    <title>ApplicationDevelopment</title>

    <!-- Base URL for routing in Blazor -->
    <base href="/" />

    <!-- Bootstrap CSS for UI styling -->
    <link rel="stylesheet" href="lib/bootstrap/dist/css/bootstrap.min.css" />

    <!-- Custom application styles -->
    <link rel="stylesheet" href="app.css" />
    <link rel="stylesheet" href="ApplicationDevelopment.styles.css" />

    <!-- Favicon -->
    <link rel="icon" href="data:,">
</head>

<body>

<!-- Safe area for mobile devices -->
<div class="status-bar-safe-area"></div>

<!-- Root container for Blazor application -->
<div id="app">Loading...</div>

<!-- Blazor error UI for unhandled exceptions -->
<div id="blazor-error-ui" data-nosnippet>
    An unhandled error has occurred.
    <a href="." class="reload">Reload</a>
    <span class="dismiss">ðŸ—™</span>
</div>

<!-- Chart.js library for rendering dashboard charts -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<script>
    // ================================
    // Mood Distribution Chart (Bar Chart)
    // Visualizes frequency of different moods
    // ================================
    window.renderMoodChart = (labels, values) => {
        const ctx = document.getElementById('moodChart');
        if (!ctx) return;

        new Chart(ctx, {
            type: 'bar',
            data: {
                labels: labels,
                datasets: [{
                    label: 'Mood Count',
                    data: values,
                    backgroundColor: '#48CAE4'
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false
            }
        });
    };

    // ================================
    // Mood Category Chart (Pie Chart)
    // Shows distribution of Positive, Neutral, Negative moods
    // ================================
    window.renderMoodCategoryChart = (labels, values) => {
        const ctx = document.getElementById('moodCategoryChart');
        if (!ctx) return;

        new Chart(ctx, {
            type: 'pie',
            data: {
                labels: labels,
                datasets: [{
                    data: values,
                    backgroundColor: [
                        '#4CAF50', // Positive
                        '#FFC107', // Neutral
                        '#F44336'  // Negative
                    ]
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false
            }
        });
    };

    // ================================
    // Entries Over Time Chart (Line Chart)
    // Displays journal activity trend over time
    // ================================
    window.renderEntryChart = (labels, values) => {
        const ctx = document.getElementById('entryChart');
        if (!ctx) return;

        new Chart(ctx, {
            type: 'line',
            data: {
                labels: labels,
                datasets: [{
                    label: 'Entries',
                    data: values,
                    borderColor: '#0077B6',
                    fill: false,
                    tension: 0.3
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false
            }
        });
    };

    // ================================
    // Most Used Tags Chart (Pie Chart)
    // Shows frequency of tags used in journal entries
    // ================================
    window.renderTagChart = (labels, values) => {
        const ctx = document.getElementById('tagChart');
        if (!ctx) return;

        new Chart(ctx, {
            type: 'pie',
            data: {
                labels: labels,
                datasets: [{
                    data: values,
                    backgroundColor: [
                        '#00B4D8',
                        '#0077B6',
                        '#48CAE4',
                        '#90E0EF',
                        '#ADE8F4',
                        '#023E8A'
                    ]
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false
            }
        });
    };

    // ================================
    // Tag Breakdown Chart (Doughnut Chart)
    // Shows percentage contribution of each tag
    // ================================
    window.renderTagBreakdownChart = (labels, values) => {
        const ctx = document.getElementById('tagBreakdownChart');
        if (!ctx) return;

        new Chart(ctx, {
            type: 'doughnut',
            data: {
                labels: labels,
                datasets: [{
                    data: values,
                    backgroundColor: [
                        '#00B4D8',
                        '#0077B6',
                        '#48CAE4',
                        '#90E0EF',
                        '#ADE8F4',
                        '#023E8A',
                        '#FFB703',
                        '#FB8500'
                    ]
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    tooltip: {
                        callbacks: {
                            // Display percentage values in tooltip
                            label: function(context) {
                                return context.label + ": " + context.raw + "%";
                            }
                        }
                    }
                }
            }
        });
    };

    // ================================
    // Word Count Trend Chart (Line Chart)
    // Shows writing activity based on word count per day
    // ================================
    window.renderWordChart = (labels, values) => {
        const ctx = document.getElementById('wordChart');
        if (!ctx) return;

        new Chart(ctx, {
            type: 'line',
            data: {
                labels: labels,
                datasets: [{
                    label: 'Words per Day',
                    data: values,
                    borderColor: '#FF6B6B',
                    backgroundColor: 'rgba(255,107,107,0.2)',
                    fill: true,
                    tension: 0.3
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false
            }
        });
    };
</script>

<!-- ================================
     Theme Manager Script
     Handles light/dark theme switching and persistence
================================ -->
<script>
    window.themeManager = {
        // Toggle between light and dark theme
        toggleTheme: function () {
            document.body.classList.toggle("dark-theme");

            if (document.body.classList.contains("dark-theme")) {
                localStorage.setItem("theme", "dark");
                return true;
            } else {
                localStorage.setItem("theme", "light");
                return false;
            }
        },

        // Check if dark mode is currently enabled
        isDarkMode: function () {
            return document.body.classList.contains("dark-theme");
        },

        // Load saved theme from local storage on app startup
        loadTheme: function () {
            const savedTheme = localStorage.getItem("theme");
            if (savedTheme === "dark") {
                document.body.classList.add("dark-theme");
            }
        }
    };

    // Apply saved theme when the application loads
    window.themeManager.loadTheme();
</script>

<!-- Blazor WebView runtime script -->
<script src="_framework/blazor.webview.js" autostart="false"></script>

</body>
</html>
